<!DOCTYPE html>
<html lang="en">

<head>
    <!-- í—¤ë” íŒŒì¼ í¬í•¨ -->
    <head th:replace="fragments/header :: header"/>

    <style>

        .card {
            width: 100%;
            /*height: 400px;*/
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .card-img-top {
            width: 100%;
            height: 200px; /* ì´ë¯¸ì§€ ë†’ì´ ê³ ì • */
            object-fit: cover; /* ì´ë¯¸ì§€ ë¹„ìœ¨ ìœ ì§€í•˜ë©° ì¹´ë“œì— ë§ê²Œ ìë¥´ê¸° */
        }

        .card-body {
            height: 100px; /* ì¹´ë“œ ë³¸ë¬¸ ë†’ì´ */
            text-align: center;
            padding: 10px;
        }


        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }

        .pagination a {
            padding: 8px 16px;
            margin: 0 4px;
            border: 1px solid #ddd;
            text-decoration: none;
        }

        .pagination a:hover {
            background-color: #f1f1f1;
        }

        .pagination .active {
            background-color: #007bff;
            color: white;
        }

        tr:hover {
            background-color: #f1f1f1;
            cursor: pointer;
        }

        .container {
            position: relative;
        }
    </style>
</head>

<body>
<!-- Navigation -->

<div th:replace="fragments/bodyHeader :: bodyHeader"></div>

<!-- Search Bar -->
<div class="container mt-4">
    <form class="d-flex align-items-center">
        <input class="form-control me-2" type="text" name="query" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
               aria-label="Search" style="max-width: 400px;">

        <button class="btn btn-outline-dark me-3" type="submit">ê²€ìƒ‰</button>
    </form>

    <form th:action="@{/search/img}" method="post" enctype="multipart/form-data">

        <!-- ì´ë¯¸ì§€ ì—…ë¡œë“œ -->
        <div class="form-group">
            <label for="imgFile">ìƒí’ˆ ì´ë¯¸ì§€</label>
            <input type="file" name="imgFile" id="imgFile" class="form-control-file"
                   accept="image/*">
        </div>

        <!-- ì œì¶œ ë²„íŠ¼ -->
        <button type="submit" class="btn btn-primary mt-3">ë“±ë¡</button>
    </form>
</div>

<!-- Section -->
<section class="py-5" style="margin-top: -100px;" th:if="${items != null}">
    <div class="container px-4 px-lg-5 mt-5">
        <div class="py-5 text-center">
            <h2>ì˜¤ëŠ˜ì˜ ì¶”ì²œ ìƒí’ˆ</h2>
            <h6>ì´ë¯¸ì§€ ê²€ìƒ‰ìœ¼ë¡œ ì›í•˜ëŠ” ìƒí’ˆì„ ì¶”ì²œ ë°›ìœ¼ì„¸ìš”</h6>
        </div>
        <div class="row gx-4 gx-lg-5 row-cols-2 row-cols-md-3 row-cols-xl-4 justify-content-center">
            <!-- Thymeleaf loop for products -->
            <div class="col mb-5" th:each="item : ${items}">
                <div class="card h-100">
                    <!-- Product image -->
                    <a th:href="@{/shop/detail/{id}(id=${item.itemId})}">

                        <img class="card-img-top img-fluid" th:if="${item.itemImageLink != null}"
                             th:src="${item.itemImageLink}"
                             th:alt="${item.itemTitle}" loading="lazy"
                             style="max-width: 400px; max-height: 400px;">
                        <!--style="width: 350px; height: 400px; object-fit: cover;"-->

                        <p th:if="${item.itemImageLink == null}">ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</p>

                    </a>
                    <!-- Product details -->
                    <div class="card-body p-4">
                        <div class="text-center">
                            <!-- Product name -->
                            <h5 class="fw-bolder" th:text="${item.itemTitle}"></h5>
                            <!-- Product price -->
                            <span th:text="${item.itemPrice} + ' ì›'"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
        <div class="pagination">
            <ul class="pagination">
                <!-- ì´ì „ í˜ì´ì§€ -->
                <li th:if="${pageDto.pageNo > 9}">
                    <a th:href="@{/shop/main(page=${(pageDto.pageNo / 10 - 1) * 10 + 1})}"
                       aria-label="Previous">&laquo;</a>
                </li>

                <!-- í˜ì´ì§€ ë²ˆí˜¸ë“¤ -->
                <li th:each="i : ${#numbers.sequence(pageDto.startPage, pageDto.endPage)}">
                    <a th:href="@{/shop/main(page=${i})}" th:text="${i}"
                       th:classappend="${i == pageDto.pageNo} ? 'active' : ''"></a>
                </li>

                <!-- ë‹¤ìŒ í˜ì´ì§€ -->
                <li th:if="${pageDto.pageNo < pageDto.totalPages}">
                    <a th:href="@{/shop/main(page=${(pageDto.pageNo / 10 + 1) * 10 + 1})}" aria-label="Next">&raquo;</a>
                </li>
            </ul>
        </div>

        <!-- More button -->
        <div class="text-sm-end">
            <a class="btn btn-outline-dark mt-auto" href="/list">ë”ë³´ê¸°</a>
        </div>
    </div>
</section>

<section class="py-5" style="margin-top: 10px;" th:if="${results != null}">
    <div class="container px-4 px-lg-5 mt-5">
        <div class="py-5 text-center">

            <h4>ğŸ“¢ í˜„ì¬ ë³´ì‹œëŠ” ìƒí’ˆê³¼ ì‹œê°ì ìœ¼ë¡œ ìœ ì‚¬í•œ ìƒí’ˆë“¤ì´ì—ìš” ğŸ“¢</h4>
        </div>
        <div class="row gx-4 gx-lg-5 row-cols-2 row-cols-md-3 row-cols-xl-4 justify-content-center">

            <div class="col mb-5" th:each="result : ${results}">
                <div class="card h-100">
                    <a th:href="@{/shop/detail/{itemId}(itemId=${result.itemId})}">
                        <img class="card-img-top img-fluid"
                             th:src="${result.imageUrl != null ? result.imageUrl : '/images/default.jpg'}"
                             th:alt="${result.itemTitle != null ? result.itemTitle : 'ìƒí’ˆ ì´ë¯¸ì§€'}"
                             loading="lazy" style="max-width: 400px;">
                    </a>
                    <div class="card-body p-4">
                        <div class="text-center">
                            <h5 class="fw-bolder"
                                th:text="${result.itemTitle != null ? result.itemTitle : 'ìƒí’ˆ ì œëª© ì—†ìŒ'}"></h5>
                            <span th:text="${result.itemPrice != null ? result.itemPrice + ' ì›' : 'ê°€ê²© ì—†ìŒ'}"></span>
                            <br>
                            <span th:text="${result.hammingDistance != null ? 'ìœ ì‚¬ë„: ' + result.hammingDistance : 'ìœ ì‚¬ë„ ì •ë³´ ì—†ìŒ'}"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Footer -->
<footer class="py-5 bg-dark">
    <div class="container">
        <p class="m-0 text-center text-white">Copyright &copy; Your Website 2023</p>
    </div>
</footer>
</body>

</html>
