<!DOCTYPE html>
<html lang="en">

<head th:replace="~{fragments/header :: header('ë©”ì¸ í˜ì´ì§€')}"></head>

<!--link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"-->
<style>

    .card {
        width: 100%;
        /*height: 400px;*/
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }

    .card-img-top {
        width: 100%;
        height: 200px; /* ì´ë¯¸ì§€ ë†’ì´ ê³ ì • */
        object-fit: cover; /* ì´ë¯¸ì§€ ë¹„ìœ¨ ìœ ì§€í•˜ë©° ì¹´ë“œì— ë§ê²Œ ìë¥´ê¸° */
    }

    .card-body {
        height: 150px; /* ì¹´ë“œ ë³¸ë¬¸ ë†’ì´ */
        text-align: center;
        padding: 10px;
    }


    .pagination {
        display: flex;
        justify-content: center;
        margin-top: 20px;
    }

    .pagination a {
        padding: 8px 16px;
        margin: 0 4px;
        border: 1px solid #ddd;
        text-decoration: none;
    }

    .pagination a:hover {
        background-color: #f1f1f1;
    }

    .pagination .active {
        background-color: #007bff;
        color: white;
    }

    tr:hover {
        background-color: #f1f1f1;
        cursor: pointer;
    }

    .container {
        position: relative;
    }


    /* íˆ´íŒ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
    .tooltip-container {
        position: relative;
        display: inline-block;
    }

    .tooltip-container .tooltip-text {
        visibility: hidden;
        width: 300px; /* íˆ´íŒ ê°€ë¡œ ê¸¸ì´ */
        height: 180px; /* íˆ´íŒ ì„¸ë¡œ ê¸¸ì´ */
        background-color: #fff; /* íˆ´íŒ ë°°ê²½ìƒ‰ */
        color: #333; /* íˆ´íŒ ê¸€ììƒ‰ */
        text-align: center;
        border-radius: 12px; /* ì¹´ë“œ ìŠ¤íƒ€ì¼ì— ë§ê²Œ ë‘¥ê¸€ê²Œ */
        padding: 20px;
        position: absolute;
        top: calc(100% + 10px); /* ë²„íŠ¼ê³¼ íˆ´íŒ ì‚¬ì´ì— 10px ê°„ê²© ì¶”ê°€ */
        left: 50%;
        transform: translateX(-50%);
        z-index: 1;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); /* ë” ë¶€ë“œëŸ¬ìš´ ê·¸ë¦¼ì */
        border: 1px solid #ddd; /* ì¹´ë“œì™€ ë¹„ìŠ·í•œ ì—°í•œ í…Œë‘ë¦¬ */
        opacity: 0; /* ì²˜ìŒì—ëŠ” ë³´ì´ì§€ ì•ŠìŒ */
        transition: opacity 0.3s ease; /* ë¶€ë“œëŸ¬ìš´ ì „í™˜ íš¨ê³¼ */
    }

    /* ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¸ì„ ë•Œ íˆ´íŒ í‘œì‹œ */
    .tooltip-container:hover .tooltip-text {
        visibility: visible;
        opacity: 1;
    }

    #search_icon {
        font-size: 18px; /* ì•„ì´ì½˜ í¬ê¸° ì¡°ì • */
        vertical-align: middle; /* ìˆ˜ì§ ì •ë ¬ */
    }
</style>

<body>
<!-- Navigation -->
<div th:insert="~{fragments/bodyHeader :: bodyHeader}"></div>

<!-- Search Bar -->
<div class="container mt-4">
    <form class="d-flex align-items-center" th:action="@{/search/img}" method="post" enctype="multipart/form-data">

        <input id="searchInput" class="form-control me-2" type="text" name="query" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
               aria-label="Search" style="max-width: 400px;">
        <!-- íŒŒì¼ ì„ íƒ input -->
        <input type="file" name="imgFile" id="imgFile" class="form-control-file d-none" accept="image/*">

        <div class="tooltip-container">
            <!-- íŒŒì¼ ì„ íƒ ë²„íŠ¼ -->
            <button type="button" class="btn btn-outline-dark me-3" id="fileSelectButton">
                íŒŒì¼ ì„ íƒ
            </button>
            <!-- íˆ´íŒ ë‚´ìš© -->
            <div class="tooltip-text">
                <h5>ì´ë¯¸ì§€ë¡œ ê²€ìƒ‰í•˜ê¸°</h5></br>
                ì´ë¯¸ì§€ ê²€ìƒ‰ìœ¼ë¡œ ì›í–ˆë˜ ìƒí’ˆì„ ë” ë‚˜ì€ ê°€ê²©ìœ¼ë¡œ ë§Œë‚˜ë³´ì„¸ìš”.

            </div>
        </div>

        <button class="btn btn-outline-dark me-3" type="submit">
            <span id="search_icon">
                <i class="fa fa-search"></i>
            </span>
        </button>

    </form>
</div>
<script>
    // íŒŒì¼ ì„ íƒ ë²„íŠ¼ê³¼ íŒŒì¼ ì„ íƒ input ì—°ê²°
    const fileSelectButton = document.getElementById('fileSelectButton');
    const fileInput = document.getElementById('imgFile');
    const fileNameDisplay = document.getElementById('fileName');

    fileSelectButton.addEventListener('click', () => {
        fileInput.click(); // ìˆ¨ê²¨ì§„ íŒŒì¼ ì…ë ¥ ì°½ ì—´ê¸°
    });

    fileInput.addEventListener('change', () => {
        if (fileInput.files.length > 0) {

            searchInput.value = fileInput.files[0].name; // ê²€ìƒ‰ì–´ ì…ë ¥ì°½ì— ì„ íƒí•œ íŒŒì¼ ì´ë¦„ í‘œì‹œ
        } else {

            searchInput.value = ''; // íŒŒì¼ ì„ íƒ ì·¨ì†Œ ì‹œ í‘œì‹œ ì´ˆê¸°í™”
        }
    });

</script>

<!-- Section -->
<section class="py-5" style="margin-top: -100px;" th:if="${items != null}">
    <div class="container px-4 px-lg-5 mt-5">
        <div class="py-5 text-center">
            <h2>ì˜¤ëŠ˜ì˜ ì¶”ì²œ ìƒí’ˆ</h2>
            <h6>ì´ë¯¸ì§€ ê²€ìƒ‰ìœ¼ë¡œ ì›í•˜ëŠ” ìƒí’ˆì„ ì¶”ì²œ ë°›ìœ¼ì„¸ìš”</h6>
        </div>
        <div class="row gx-4 gx-lg-5 row-cols-2 row-cols-md-3 row-cols-xl-4 justify-content-center">
            <!-- Thymeleaf loop for products -->
            <div class="col mb-5" th:each="item : ${items}">
                <div class="card h-100">
                    <!-- Product image -->
                    <a th:href="@{/shop/detail/{id}(id=${item.itemId})}">

                        <img class="card-img-top img-fluid" th:if="${item.itemImageLink != null}"
                             th:src="${item.itemImageLink}"
                             th:alt="${item.itemTitle}" loading="lazy"
                             style="max-width: 400px; max-height: 400px;">
                        <!--style="width: 350px; height: 400px; object-fit: cover;"-->

                        <p th:if="${item.itemImageLink == null}">ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</p>

                    </a>
                    <!-- Product details -->
                    <div class="card-body p-4">
                        <div class="text-center">
                            <!-- Product name -->
                            <h5 class="fw-bolder" th:text="${item.itemTitle}"></h5>
                            <!-- Product price -->
                            <span th:text="${item.itemPrice} + ' ì›'"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
        <div class="pagination">
            <ul class="pagination">
                <!-- ì´ì „ í˜ì´ì§€ -->
                <li th:if="${pageDto.pageNo > 9}">
                    <a th:href="@{/shop/main(page=${(pageDto.pageNo / 10 - 1) * 10 + 1})}"
                       aria-label="Previous">&laquo;</a>
                </li>

                <!-- í˜ì´ì§€ ë²ˆí˜¸ë“¤ -->
                <li th:each="i : ${#numbers.sequence(pageDto.startPage, pageDto.endPage)}">
                    <a th:href="@{/shop/main(page=${i})}" th:text="${i}"
                       th:classappend="${i == pageDto.pageNo} ? 'active' : ''"></a>
                </li>

                <!-- ë‹¤ìŒ í˜ì´ì§€ -->
                <li th:if="${pageDto.pageNo < pageDto.totalPages}">
                    <a th:href="@{/shop/main(page=${(pageDto.pageNo / 10 + 1) * 10 + 1})}" aria-label="Next">&raquo;</a>
                </li>
            </ul>
        </div>

        <!-- More button -->
        <div class="text-sm-end">
            <a class="btn btn-outline-dark mt-auto" href="/list">ë”ë³´ê¸°</a>
        </div>
    </div>
</section>

<section class="py-5" style="margin-top: 10px;" th:if="${results != null}">
    <div class="container px-4 px-lg-5 mt-5">
        <div class="py-5 text-center">

            <h4>ğŸ“¢ í˜„ì¬ ë³´ì‹œëŠ” ìƒí’ˆê³¼ ì‹œê°ì ìœ¼ë¡œ ìœ ì‚¬í•œ ìƒí’ˆë“¤ì´ì—ìš” ğŸ“¢</h4>
        </div>
        <div class="row gx-4 gx-lg-5 row-cols-2 row-cols-md-3 row-cols-xl-4 justify-content-center">

            <div class="col mb-5" th:each="result : ${results}">
                <div class="card h-100">
                    <a th:href="@{/shop/detail/{itemId}(itemId=${result.itemId})}">
                        <img class="card-img-top img-fluid"
                             th:src="${result.imageUrl != null ? result.imageUrl : '/images/default.jpg'}"
                             th:alt="${result.itemTitle != null ? result.itemTitle : 'ìƒí’ˆ ì´ë¯¸ì§€'}"
                             loading="lazy" style="max-width: 400px; max-height: 400px;">
                    </a>
                    <div class="card-body p-4">
                        <div class="text-center">
                            <h6 class="fw-bolder"
                                th:text="${result.itemTitle != null ? result.itemTitle : 'ìƒí’ˆ ì œëª© ì—†ìŒ'}"></h6>
                            <span th:text="${result.itemPrice != null ? result.itemPrice + ' ì›' : 'ê°€ê²© ì—†ìŒ'}"></span>
                            <br>
                            <span th:text="${result.hammingDistance != null ? 'ìœ ì‚¬ë„: ' + result.hammingDistance : 'ìœ ì‚¬ë„ ì •ë³´ ì—†ìŒ'}"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Footer -->
<footer class="py-5 bg-dark">
    <div class="container">
        <p class="m-0 text-center text-white">Copyright &copy; Your Website 2023</p>
    </div>
</footer>
</body>

</html>
